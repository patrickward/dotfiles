# Clean up merged branches with confirmation
if ! git rev-parse --git-dir > /dev/null 2>&1; then
    echo "Not a git repository"
    return 1
fi

local base=${1:-main}

local branches=$(git branch --merged origin/$base | \
    grep -v "^\*" | \
    grep -v "main" | \
    grep -v "master" | \
    grep -v "develop" | \
    sed 's/^[[:space:]]*//')

if [ -z "$branches" ]; then
    echo "No merged branches to clean up"
    return 0
fi

echo "Branches merged into origin/$base:"
echo "$branches" | sed 's/^/  /'

echo -n "\nDelete these branches? (y/N): "
read response
if [[ ! "$response" =~ ^[Yy]$ ]]; then
    echo "Cancelled"
    return 0
fi

echo "$branches" | while read branch; do
    git branch -d "$branch" && echo "  âœ“ Deleted: $branch"
done

